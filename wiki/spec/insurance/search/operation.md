# 查詢 - 操作

## 功能
* 針對保單進行作業指令
* 該保單操作後將顯示於作業序列
* 依使用者提供之條件可查詢保單詳細資料
* 提供保/表單 PDF 下載預覽
* 可匯出當前查詢結果之 csv 檔

## 鎖定規則
| 項目     | 說明                                                                                   |
| -------- | -------------------------------------------------------------------------------------- |
| 查詢按鈕 | 需選擇或輸入任一條件, 否則鎖定 <br> 若未選擇批次日期, 將只查詢90天內資料               |
| PDF      | 未轉檔將鎖定 `progress === 'RC'` <br> 超過7天, 後端 flag `PDF_REMOVED === true` 將鎖定 |

## 查詢條件、欄位名稱
| 項目                | API Parameters   | 說明                                                    |
| ------------------- | ---------------- | ------------------------------------------------------- |
| 保單/表單號碼       | name             | 表單: 一些例行性資料，像是每月季報                      |
| 批次日期            | cycle_date       | 自動化抓取(台壽)xml、(遠雄)csv資料的時間                |
| 業務來源 (台壽)     | billing_category | 該保/表單所屬的一級單位業務部門                         |
| 發單類別 (遠雄)     | billing_category | 該保/表單所屬的一級單位業務部門                         |
| 業務關聯代碼 (台壽) | unit_id          | 該保/表單所屬的二級單位業務部門                         |
| 單位識別碼 (遠雄)   | unit_id          | 該保單之所屬單位識別碼                                  |
| 通路                | channel          | 該客戶由哪個通路投保的                                  |
| 狀態                | status           | N: 正常 R: 退件(未列印成實體/非電子檔) CR: 驗退 P: 抽件 |
| 批次類型            | cycle_type       | B: 正常 O: 急件                                         |
| 險種代碼            | type_code        | 財產保險各險種之代碼                                    |
| 寄送類型            | mail_type        | 該保單寄出之寄送日期                                    |

## 作業
> 該保單已於作業序列中將無法操作

| 項目     | 說明                                                       |
| -------- | ---------------------------------------------------------- |
| 抽件     | status: N (正常件)、 P(抽件) 可執行                        |
| 變更地址 | status: N (正常件)、 P(抽件) 可執行                        |
| 放行     | status: CR(驗退)、 P(抽件) 可執行                          |
| 驗退     | status: N (正常件)、 P(抽件) 可執行                        |
| PDF      | 未轉檔 progress: RC、至今超過7天 PDF_REMOVED = true 時鎖定 |

## 相依元件
#### ConfirmModal

#### 路徑 
`@/components/modal/confirm/operation.vue`

#### 功能
* 使用者按下作業按鈕可於平台建立作業序列
* 抽件、放行、驗退
    * 輸入原因 (選填)
* 變更地址
    * 輸入地址 (必填)
* 填寫原因後系統需補上指令類型
    * `(抽件) 抽件原因`
    * ```
        (變更地址)
            > 新北市OOOXXXX
      ```
    * `(放行) 放行原因`
    * `(線上驗退) 驗退原因`

## 業務邏輯
* 7個工作天後屏蔽個資(後端屏蔽)
    * 要保人
    * 被保人
    * 收件人
    * 收件地址